import{_ as i,c as l,b as s,a as c,e,d,w as p,r,o as t}from"./app-CJlkTddN.js";const v={};function o(m,n){const a=r("RouteLink");return t(),l("div",null,[n[4]||(n[4]=s("h1",{id:"rocketmq-message-queue-integration",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#rocketmq-message-queue-integration"},[s("span",null,"RocketMQ message queue integration")])],-1)),n[5]||(n[5]=s("h2",{id:"prerequisite-building-rocketmq-service",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#prerequisite-building-rocketmq-service"},[s("span",null,"Prerequisite: Building RocketMQ Service")])],-1)),s("blockquote",null,[s("p",null,[n[1]||(n[1]=e("Currently only supports RocketMQ 4.x, not RocketMQ 5.x.")),n[2]||(n[2]=s("br",null,null,-1)),n[3]||(n[3]=e(" Quick Installation Reference Document ")),d(a,{to:"/syncboot/microservice/docker/rocketmq.html"},{default:p(()=>n[0]||(n[0]=[e("Docker Installation RocketMQ")])),_:1})])]),n[6]||(n[6]=c(`<h2 id="syncboot-integrates-rocketmq" tabindex="-1"><a class="header-anchor" href="#syncboot-integrates-rocketmq"><span>SyncBoot integrates RocketMQ</span></a></h2><h3 id="mq-integration-and-configuration" tabindex="-1"><a class="header-anchor" href="#mq-integration-and-configuration"><span>MQ Integration and Configuration</span></a></h3><h4 id="dependency-reference" tabindex="-1"><a class="header-anchor" href="#dependency-reference"><span>Dependency Reference</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">&lt;dependency&gt;</span>
<span class="line">    &lt;groupId&gt;org.jeecgframework.boot&lt;/groupId&gt;</span>
<span class="line">    &lt;artifactId&gt;jeecg-cloud-test-rocketmq&lt;/artifactId&gt;</span>
<span class="line">    &lt;version&gt;\${jeecgboot.version}&lt;/version&gt;</span>
<span class="line">&lt;/dependency&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h4 id="add-configuration" tabindex="-1"><a class="header-anchor" href="#add-configuration"><span>Add Configuration</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">rocketmq:</span>
<span class="line">  name-server: jeecg-boot-rocketmq:9876</span>
<span class="line">  producer:</span>
<span class="line">    group: jeecg-group</span>
<span class="line">    sendMessageTimeout: 300000</span>
<span class="line">    tls-enable: false</span>
<span class="line">spring:</span>
<span class="line">  cloud:</span>
<span class="line">    stream:</span>
<span class="line">      rocketmq:</span>
<span class="line">        binder:</span>
<span class="line">          name-server: \${rocketmq.name-server} # RocketMQ Namesrv 地址</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h3 id="use-of-mq" tabindex="-1"><a class="header-anchor" href="#use-of-mq"><span>Use of MQ</span></a></h3><h4 id="normal-message-occurs" tabindex="-1"><a class="header-anchor" href="#normal-message-occurs"><span>Normal message occurs</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">@Autowired</span>
<span class="line">private RabbitMqClient rabbitMqClient;</span>
<span class="line"></span>
<span class="line">rabbitMqClient.sendMessage(CloudConstant.MQ_JEECG_PLACE_ORDER, map);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h4 id="send-delayed-message" tabindex="-1"><a class="header-anchor" href="#send-delayed-message"><span>Send Delayed Message</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">@Autowired</span>
<span class="line">private RabbitMqClient rabbitMqClient;</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 延迟消息， delayLevel取如下列表中的值</span>
<span class="line">     * Level 1: 1s（1秒）</span>
<span class="line">     * Level 2: 5s（5秒）</span>
<span class="line">     * Level 3: 10s（10秒）</span>
<span class="line">     * Level 4: 30s（30秒）</span>
<span class="line">     * Level 5: 1m（1分钟）</span>
<span class="line">     * Level 6: 2m（2分钟）</span>
<span class="line">     * Level 7: 3m（3分钟）</span>
<span class="line">     * Level 8: 4m（4分钟）</span>
<span class="line">     * Level 9: 5m（5分钟）</span>
<span class="line">     * Level 10: 6m（6分钟）</span>
<span class="line">     * Level 11: 7m（7分钟）</span>
<span class="line">     * Level 12: 8m（8分钟）</span>
<span class="line">     * Level 13: 9m（9分钟）</span>
<span class="line">     * Level 14: 10m（10分钟）</span>
<span class="line">     * Level 15: 20m（20分钟）</span>
<span class="line">     * Level 16: 30m（30分钟）</span>
<span class="line">     * Level 17: 1h（1小时）</span>
<span class="line">     * Level 18: 2h（2小时）</span>
<span class="line">     */</span>
<span class="line">rabbitMqClient.sendMessage(CloudConstant.MQ_JEECG_PLACE_ORDER_TIME, map,2);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h4 id="define-normal-message-monitoring-and-delayed-message-monitoring" tabindex="-1"><a class="header-anchor" href="#define-normal-message-monitoring-and-delayed-message-monitoring"><span>Define normal message monitoring and delayed message monitoring</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">@Component</span>
<span class="line">// 监听topic名称，消费组</span>
<span class="line">@RocketMQMessageListener(topic = CloudConstant.MQ_JEECG_PLACE_ORDER, consumerGroup = &quot;helloReceiver1&quot;)</span>
<span class="line">public class HelloReceiver1 implements RocketMQListener&lt;BaseMap&gt; {</span>
<span class="line"></span>
<span class="line">    public void onMessage(BaseMap baseMap) {</span>
<span class="line">        log.info(&quot;helloReceiver1接收消息：&quot; + baseMap);</span>
<span class="line">    }</span>
<span class="line"></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><hr><h3 id="use-of-message-bus" tabindex="-1"><a class="header-anchor" href="#use-of-message-bus"><span>Use of message bus</span></a></h3><h4 id="bus-message-occurs" tabindex="-1"><a class="header-anchor" href="#bus-message-occurs"><span>Bus message occurs</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">@Autowired</span>
<span class="line">private RabbitMqClient rabbitMqClient;</span>
<span class="line"></span>
<span class="line">//rocketmq消息总线测试</span>
<span class="line">BaseMap params = new BaseMap();</span>
<span class="line">params.put(&quot;orderId&quot;, &quot;123456&quot;);</span>
<span class="line">rabbitMqClient.publishEvent(CloudConstant.MQ_DEMO_BUS_EVENT, params);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h4 id="bus-message-monitoring" tabindex="-1"><a class="header-anchor" href="#bus-message-monitoring"><span>Bus message monitoring</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">@Component(CloudConstant.MQ_DEMO_BUS_EVENT)</span>
<span class="line">public class DemoBusEvent implements JeecgBusEventHandler {</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    @Override</span>
<span class="line">    public void onMessage(EventObj obj) {</span>
<span class="line">        if (ObjectUtil.isNotEmpty(obj)) {</span>
<span class="line">            BaseMap baseMap = obj.getBaseMap();</span>
<span class="line">            String orderId = baseMap.get(&quot;orderId&quot;);</span>
<span class="line">            log.info(&quot;业务处理----订单ID:&quot; + orderId);</span>
<span class="line">        }</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h3 id="consumer-group" tabindex="-1"><a class="header-anchor" href="#consumer-group"><span>Consumer Group</span></a></h3><h4 id="rocketmq-consumer-group" tabindex="-1"><a class="header-anchor" href="#rocketmq-consumer-group"><span>rocketmq consumer group</span></a></h4><p>In the monitoring consumption annotation <code>@RocketMQMessageListener</code>, in addition to topic, there is a mandatory parameter consumeGroup, the consumer group name. RocketMQ does not provide consumer group configuration by default, and you need to specify the consumer group name yourself. However, in the monitoring consumption annotation, there is a configuration that meets the common message scenario, so you only need to specify a consumer name. You can also specify <code>rocketmq.consumer</code>the configuration of the consumer group to <code>rocketmq.consumer.group</code>match the consumerGroup name in the annotation to use the consumption configuration in the configuration file. Configurations with different group names are not shared. The following configuration is the configuration for multiple consumer groups to consume a topic</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">@RocketMQMessageListener(topic = CloudConstant.MQ_JEECG_PLACE_ORDER, consumerGroup = &quot;helloReceiver1&quot;)</span>
<span class="line"></span>
<span class="line">@RocketMQMessageListener(topic = CloudConstant.MQ_JEECG_PLACE_ORDER, consumerGroup = &quot;helloReceiver2&quot;)</span>
<span class="line"></span>
<span class="line">@RocketMQMessageListener(topic = CloudConstant.MQ_JEECG_PLACE_ORDER, consumerGroup = &quot;helloReceiver3&quot;)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h4 id="rocketmq-production-group" tabindex="-1"><a class="header-anchor" href="#rocketmq-production-group"><span>rocketmq production group</span></a></h4><p>Currently, production configuration only supports <code>rocketmq.produce</code>configuration. If multiple production groups are required, the production group names between different applications can be modified.</p><h4 id="rocketmq-client-api" tabindex="-1"><a class="header-anchor" href="#rocketmq-client-api"><span>RocketMQ Client API</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">   /**</span>
<span class="line">     * 同步发送</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     */</span>
<span class="line">    public void sendMessage(String topic, Object payload)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 同步批量发送</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     * @return</span>
<span class="line">     * @param &lt;T&gt;</span>
<span class="line">     */</span>
<span class="line">    public &lt;T&gt; SendResult sendMessage(String topic, Collection&lt;T&gt; payload)</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 异步发送</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     * @param callback</span>
<span class="line">     */</span>
<span class="line">    public void sendAsyncMessage(String topic, Object payload, SendCallback callback)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 异步批量发送</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     * @param sendCallback</span>
<span class="line">     * @param &lt;T&gt;</span>
<span class="line">     */</span>
<span class="line">    public &lt;T&gt; void sendAsyncMessage(String topic, Collection&lt;T&gt; payload, SendCallback sendCallback)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 同步发送顺序消息</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     * @param hashKey</span>
<span class="line">     */</span>
<span class="line">    public void sendOrderlyMessage(String topic, Object payload, String hashKey)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 异步发送顺序消息</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     * @param hashKey</span>
<span class="line">     * @param callback</span>
<span class="line">     */</span>
<span class="line">    public void sendAsyncOrderlyMessage(String topic, Object payload, String hashKey, SendCallback callback)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * Oneway消息</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     */</span>
<span class="line">    public void sendOneway(String topic, Object payload)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 顺序Oneway消息</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     * @param hashKey</span>
<span class="line">     */</span>
<span class="line">    public void sendOnewayOrderly(String topic, Object payload, String hashKey)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 事务消息</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     * @param arg</span>
<span class="line">     */</span>
<span class="line">    public void sendMessageInTransaction(String topic, Object payload, Object arg)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * pull模式</span>
<span class="line">     * 拉取消息</span>
<span class="line">     * @param clazz</span>
<span class="line">     * @return</span>
<span class="line">     * @param &lt;T&gt;</span>
<span class="line">     */</span>
<span class="line">    public &lt;T&gt; List&lt;T&gt; receive(Class&lt;T&gt; clazz)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 延迟消息， delayLevel取如下列表中的值，等后续rocket-spring升到2.3.0时，可以设置延迟多少秒，目前适配版本只能设置延迟等级</span>
<span class="line">     * Level 1: 1s（1秒）</span>
<span class="line">     * Level 2: 5s（5秒）</span>
<span class="line">     * Level 3: 10s（10秒）</span>
<span class="line">     * Level 4: 30s（30秒）</span>
<span class="line">     * Level 5: 1m（1分钟）</span>
<span class="line">     * Level 6: 2m（2分钟）</span>
<span class="line">     * Level 7: 3m（3分钟）</span>
<span class="line">     * Level 8: 4m（4分钟）</span>
<span class="line">     * Level 9: 5m（5分钟）</span>
<span class="line">     * Level 10: 6m（6分钟）</span>
<span class="line">     * Level 11: 7m（7分钟）</span>
<span class="line">     * Level 12: 8m（8分钟）</span>
<span class="line">     * Level 13: 9m（9分钟）</span>
<span class="line">     * Level 14: 10m（10分钟）</span>
<span class="line">     * Level 15: 20m（20分钟）</span>
<span class="line">     * Level 16: 30m（30分钟）</span>
<span class="line">     * Level 17: 1h（1小时）</span>
<span class="line">     * Level 18: 2h（2小时）</span>
<span class="line">     * @param topic</span>
<span class="line">     * @param payload</span>
<span class="line">     * @param delayLevel</span>
<span class="line">     * @return</span>
<span class="line">     */</span>
<span class="line">    public SendResult sendMessage(String topic, Object payload, Integer delayLevel)</span>
<span class="line"></span>
<span class="line">    /**</span>
<span class="line">     * 发送远程事件</span>
<span class="line">     *</span>
<span class="line">     * @param handlerName</span>
<span class="line">     * @param baseMap</span>
<span class="line">     */</span>
<span class="line">    public void publishEvent(String handlerName, BaseMap baseMap)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,35))])}const b=i(v,[["render",o]]),g=JSON.parse('{"path":"/syncboot/microservice/common-starter-integration/rocketmq-message-queue-integration.html","title":"RocketMQ message queue integration","lang":"ko-KR","frontmatter":{"order":8},"git":{"updatedTime":1749179241000,"contributors":[{"name":"poh","username":"poh","email":"poh@empasy.com","commits":1,"url":"https://github.com/poh"}],"changelog":[{"hash":"a96cbbf1f6c96d0e9d6bafa4174131f10429b849","time":1749179241000,"email":"poh@empasy.com","author":"poh","message":"sync 제품군 추가"}]},"filePathRelative":"syncboot/microservice/common-starter-integration/rocketmq-message-queue-integration.md"}');export{b as comp,g as data};
