<!doctype html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.22" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/images/logo.png"><meta name="author" content="The VuePress Team"><meta name="keywords" content="vuepress, vue, Documentation, Blog"><meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png"><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#3eaf7c"><meta name="msapplication-TileImage" content="/images/icons/mstile-150x150.png"><meta name="msapplication-TileColor" content="#3eaf7c"><meta name="application-name" content="VuePress Document templates"><meta name="mobile-web-app-capable" content="yes"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><title>Distributed transaction Seata integration</title><meta name="description" content="The Empasy document">
    <link rel="preload" href="/assets/style-BvRKiRGL.css" as="style"><link rel="stylesheet" href="/assets/style-BvRKiRGL.css">
    <link rel="modulepreload" href="/assets/app-QFoJTndn.js"><link rel="modulepreload" href="/assets/distributed-transaction-seata-integration.html-Ce6PWZzC.js">
    
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="/.vuepress/public/images/logo-dark.png" alt><!----></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Homepage"><!--[--><!--[--><!--]--><!--]-->Homepage<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synceta/" aria-label="SyncETA"><!--[--><!--[--><!--]--><!--]-->SyncETA<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/syncboot/" aria-label="SyncBoot"><!--[--><!--[--><!--]--><!--]-->SyncBoot<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synccms/" aria-label="SyncCms"><!--[--><!--[--><!--]--><!--]-->SyncCms<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/syncadmin/" aria-label="SyncAdmin"><!--[--><!--[--><!--]--><!--]-->SyncAdmin<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/yourusername/vuepress-template" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->GitHub<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search for documents" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Homepage"><!--[--><!--[--><!--]--><!--]-->Homepage<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synceta/" aria-label="SyncETA"><!--[--><!--[--><!--]--><!--]-->SyncETA<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/syncboot/" aria-label="SyncBoot"><!--[--><!--[--><!--]--><!--]-->SyncBoot<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synccms/" aria-label="SyncCms"><!--[--><!--[--><!--]--><!--]-->SyncCms<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/syncadmin/" aria-label="SyncAdmin"><!--[--><!--[--><!--]--><!--]-->SyncAdmin<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/yourusername/vuepress-template" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->GitHub<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading collapsible">SyncBoot <span class="right arrow"></span></p><ul style="display:none;" class="vp-sidebar-children"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item" href="/syncboot/" aria-label="Summary"><!--[--><!--[--><!--]--><!--]-->Summary<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/syncboot/getting-started.html" aria-label="Getting Started"><!--[--><!--[--><!--]--><!--]-->Getting Started<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/syncboot/Introduction.html" aria-label="Introduction"><!--[--><!--[--><!--]--><!--]-->Introduction<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="distributed-transaction-seata-integration" tabindex="-1"><a class="header-anchor" href="#distributed-transaction-seata-integration"><span>Distributed transaction Seata integration</span></a></h1><h2 id="prepare-the-environment" tabindex="-1"><a class="header-anchor" href="#prepare-the-environment"><span><strong>Prepare the environment</strong></span></a></h2><ol><li>Create four databases as follows</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">jeecg_order（订单数据库）</span>
<span class="line">jeecg_account（账户数据库）</span>
<span class="line">jeecg_product（商品数据库）</span>
<span class="line">seata（seata数据库）</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><p>The above database script has been stored in the jeecg-cloud-test-seata example. The file location is shown in the figure below.<br><img src="https://lfs.k.topthink.com/lfs/47dc02c3fac2edc3629c96cdbafab9a832dde7c37f922b59dd22ec6bff1d743e.dat" alt=""><br><img src="https://lfs.k.topthink.com/lfs/42da72534145eed89667a172bc283bdda60d17f4667ce3409f1c42ae713b3de7.dat" alt=""><br><img src="https://lfs.k.topthink.com/lfs/3e1d8b6e34ff5949d41f81449c60396cd714bb20a00fdc0867f5601875e09830.dat" alt=""><br><img src="https://lfs.k.topthink.com/lfs/f2ef165c8690d16a8bf81eb9795613ec449d2890896d7ada70a78516fe2f79ee.dat" alt=""></p><ol start="2"><li><p>Sample code:<br> jeecg-cloud-test-seata-order (order service)<br> jeecg-cloud-test-seata-product (inventory service)<br> jeecg-cloud-test-seata-account (account service)<br> This sample scenario is used to check whether the inventory is sufficient and the balance is sufficient when placing an order. If one of the conditions is not met, the transaction is rolled back.</p></li><li><p>Seata server: The version of Seata used in this practice is v1.4.2. Download it from <a href="http://seata.io/zh-cn/blog/download.html" target="_blank" rel="noopener noreferrer">http://seata.io/zh-cn/blog/download.html.</a><br> Install the server,<br> download it and unzip it. The directory structure is as follows:<br><img src="https://lfs.k.topthink.com/lfs/c96e87c7cba2a64f731a3a40d3fca403a53ad426123dc3361299fa1b03e10f26.dat" alt=""></p></li></ol><p>Enter the bin directory and start seata. The default port of seata is 8091.<br><img src="https://lfs.k.topthink.com/lfs/cc7e1cce2499681678e9065627460f0bfcd1a0d805a26793a74a5965fb00bb50.dat" alt=""></p><p>Run under Windows <code>seata-server.bat</code><br> Run under Linux<code>seata-server.sh</code></p><h2 id="testing-distributed-transactions" tabindex="-1"><a class="header-anchor" href="#testing-distributed-transactions"><span><strong>Testing distributed transactions</strong></span></a></h2><ol><li><p>Modify the file.conf file (if you need to use nacos, modify type=nacos), as shown below<br><img src="https://lfs.k.topthink.com/lfs/4b6c08ab02021d9404770e39198d7e1e214dab7e885623bfd05e77f827654eb3.dat" alt=""></p></li><li><p>Modify registry.conf (if you need to use nacos, modify type=nacos), as shown below<br><img src="https://lfs.k.topthink.com/lfs/0c3e7ec98282b80db79ecefa8f785f463ca31eedb33b158258e9b9f7c438adbe.dat" alt=""><br><img src="https://lfs.k.topthink.com/lfs/4260840ab08b826679ee162373f204b68f27a7601dcf55d3de65bbf5d81c0801.dat" alt=""></p></li><li><p>Start seata, as shown below<br><img src="https://lfs.k.topthink.com/lfs/2b242ac069a7b1e05fc55d383a7886a0bb82968cd57b62a9010e4afe7f941d4b.dat" alt=""><br> Enter the following information to indicate successful startup<br><img src="https://lfs.k.topthink.com/lfs/6ed0ea5c8f6f3c535f3ddbc239277e1d7abb690cf45b0096bbfed290165d4cfd.dat" alt=""></p></li></ol><p>4. Add dependencies to the microservice module. Please refer to the sample code for details.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">&lt;dependency&gt;</span>
<span class="line">    &lt;groupId&gt;org.jeecgframework.boot&lt;/groupId&gt;</span>
<span class="line">    &lt;artifactId&gt;jeecg-boot-starter-cloud&lt;/artifactId&gt;</span>
<span class="line">    &lt;version&gt;3.1.0&lt;/version&gt;</span>
<span class="line">&lt;/dependency&gt;</span>
<span class="line">&lt;dependency&gt;</span>
<span class="line">    &lt;groupId&gt;org.jeecgframework.boot&lt;/groupId&gt;</span>
<span class="line">    &lt;artifactId&gt;jeecg-boot-starter-seata&lt;/artifactId&gt;</span>
<span class="line">    &lt;version&gt;3.1.0&lt;/version&gt;</span>
<span class="line">&lt;/dependency&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><p>5. Add configuration to the microservice module, refer to the sample code for details</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">seata:</span>
<span class="line">  enable-auto-data-source-proxy: false</span>
<span class="line">  service:</span>
<span class="line">    grouplist:</span>
<span class="line">      default: 127.0.0.1:8091</span>
<span class="line">    vgroup-mapping:</span>
<span class="line">      springboot-seata-group: default</span>
<span class="line">  # seata 事务组编号 用于TC集群名</span>
<span class="line">  tx-service-group: springboot-seata-group</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><p>6. Start the test<br> and start<br> jeecg-cloud-test-seata-order (order service),<br> jeecg-cloud-test-seata-product (inventory service), and<br> jeecg-cloud-test-seata-account (account service)<br> in sequence. The startup is completed as shown below<br><img src="https://lfs.k.topthink.com/lfs/1fae147807c9c6f6cd97053c5306c3e115c03da21b7bc82ebda19b73d45c36fd.dat" alt=""><br><a href="http://localhost:5001" target="_blank" rel="noopener noreferrer">Enter http://localhost:5001</a> in the browser to test. As shown in the figure below,<br> the test is normal. See the screenshot for parameters<br><img src="https://lfs.k.topthink.com/lfs/8e52624c0117257a1347a4bbbf361a5359aa00cf4f662841c7757fe10e3d10a0.dat" alt=""><br> Test insufficient balance, test insufficient inventory, and then observe whether the inserted data in the database order table is rolled back</p><p>Note: This example does not go through the gateway, so you need to exclude authentication permissions. Add the following code to ShiroConfig.java</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">//测试模块排除</span>
<span class="line">filterChainDefinitionMap.put(&quot;/test/seata/**&quot;, &quot;anon&quot;);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><p>You can use nacos as the configuration center of seata<br> to create a new seataServer.properties configuration file with the following content</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"># 数据存储方式，db代表数据库</span>
<span class="line">store.mode=db</span>
<span class="line">store.db.datasource=druid</span>
<span class="line">store.db.dbType=mysql</span>
<span class="line">store.db.driverClassName=com.mysql.cj.jdbc.Driver</span>
<span class="line">store.db.url=jdbc:mysql://localhost:3300/seata?useUnicode=true&amp;rewriteBatchedStatements=true&amp;serverTimezone=Asia/Seoul</span>
<span class="line">store.db.user=root</span>
<span class="line">store.db.password=root</span>
<span class="line">store.db.minConn=5</span>
<span class="line">store.db.maxConn=30</span>
<span class="line">store.db.globalTable=global_table</span>
<span class="line">store.db.branchTable=branch_table</span>
<span class="line">store.db.queryLimit=100</span>
<span class="line">store.db.lockTable=lock_table</span>
<span class="line">store.db.maxWait=5000</span>
<span class="line"># 事务、日志等配置</span>
<span class="line">server.recovery.committingRetryPeriod=1000</span>
<span class="line">server.recovery.asynCommittingRetryPeriod=1000</span>
<span class="line">server.recovery.rollbackingRetryPeriod=1000</span>
<span class="line">server.recovery.timeoutRetryPeriod=1000</span>
<span class="line">server.maxCommitRetryTimeout=-1</span>
<span class="line">server.maxRollbackRetryTimeout=-1</span>
<span class="line">server.rollbackRetryTimeoutUnlockEnable=false</span>
<span class="line">server.undo.logSaveDays=7</span>
<span class="line">server.undo.logDeletePeriod=86400000</span>
<span class="line"></span>
<span class="line"># 客户端与服务端传输方式</span>
<span class="line">transport.serialization=seata</span>
<span class="line">transport.compressor=none</span>
<span class="line"># 关闭metrics功能，提高性能</span>
<span class="line">metrics.enabled=false</span>
<span class="line">metrics.registryType=compact</span>
<span class="line">metrics.exporterList=prometheus</span>
<span class="line">metrics.exporterPrometheusPort=9898</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link label" href="https://github.com/yourusername/vuepress-template/edit/main/docs/syncboot/microservice/common-starter-integration/distributed-transaction-seata-integration.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><svg class="edit-icon" viewbox="0 0 1024 1024"><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]--><!--]-->Edit this page on GitHub<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last updated: </span><time class="meta-item-info" datetime="2025-06-06T03:07:21.000Z" data-allow-mismatch>25. 6. 6. 오후 12:07</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: poh@empasy.com">poh</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-QFoJTndn.js" defer></script>
  </body>
</html>
