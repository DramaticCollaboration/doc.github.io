<!doctype html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.22" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/images/logo.png"><meta name="author" content="The VuePress Team"><meta name="keywords" content="vuepress, vue, Documentation, Blog"><meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png"><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#3eaf7c"><meta name="msapplication-TileImage" content="/images/icons/mstile-150x150.png"><meta name="msapplication-TileColor" content="#3eaf7c"><meta name="application-name" content="VuePress Document templates"><meta name="mobile-web-app-capable" content="yes"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><title>ShardingSphere</title><meta name="description" content="The Empasy document">
    <link rel="preload" href="/assets/style-BvRKiRGL.css" as="style"><link rel="stylesheet" href="/assets/style-BvRKiRGL.css">
    <link rel="modulepreload" href="/assets/app-QFoJTndn.js"><link rel="modulepreload" href="/assets/sharding-sphere.html-Cvd7FldZ.js">
    
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="/.vuepress/public/images/logo-dark.png" alt><!----></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Homepage"><!--[--><!--[--><!--]--><!--]-->Homepage<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synceta/" aria-label="SyncETA"><!--[--><!--[--><!--]--><!--]-->SyncETA<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/syncboot/" aria-label="SyncBoot"><!--[--><!--[--><!--]--><!--]-->SyncBoot<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synccms/" aria-label="SyncCms"><!--[--><!--[--><!--]--><!--]-->SyncCms<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/syncadmin/" aria-label="SyncAdmin"><!--[--><!--[--><!--]--><!--]-->SyncAdmin<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/yourusername/vuepress-template" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->GitHub<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search for documents" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Homepage"><!--[--><!--[--><!--]--><!--]-->Homepage<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synceta/" aria-label="SyncETA"><!--[--><!--[--><!--]--><!--]-->SyncETA<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/syncboot/" aria-label="SyncBoot"><!--[--><!--[--><!--]--><!--]-->SyncBoot<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synccms/" aria-label="SyncCms"><!--[--><!--[--><!--]--><!--]-->SyncCms<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/syncadmin/" aria-label="SyncAdmin"><!--[--><!--[--><!--]--><!--]-->SyncAdmin<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/yourusername/vuepress-template" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->GitHub<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading collapsible">SyncBoot <span class="right arrow"></span></p><ul style="display:none;" class="vp-sidebar-children"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item" href="/syncboot/" aria-label="Summary"><!--[--><!--[--><!--]--><!--]-->Summary<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/syncboot/getting-started.html" aria-label="Getting Started"><!--[--><!--[--><!--]--><!--]-->Getting Started<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/syncboot/Introduction.html" aria-label="Introduction"><!--[--><!--[--><!--]--><!--]-->Introduction<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="shardingsphere" tabindex="-1"><a class="header-anchor" href="#shardingsphere"><span>ShardingSphere</span></a></h1><p>This article aims to explain the usage of sharding by integrating the sharding example of the jeecg-system-cloud-start project</p><h2 id="prepare-the-environment" tabindex="-1"><a class="header-anchor" href="#prepare-the-environment"><span><strong>Prepare the environment</strong></span></a></h2><ol><li>Data table: <code>sys_log0（日志分表1）</code>, just <code>sys_log1（日志分表2）</code>copy the system <code>sys_log</code>table</li><li>Database: <code>jeecg-boot2</code>(just copy jeecg-boot, separate database and table for use)</li></ol><h3 id="sample-code" tabindex="-1"><a class="header-anchor" href="#sample-code"><span><strong>Sample Code</strong></span></a></h3><p>The sample code <code>jeecg-cloud-test-shardingsphere</code>is written in . This sample scenario is used to store logs in separate tables when inserting logs. The table partitioning rule is to calculate the remainder according to the log type. The remainder of 0 is stored in <code>sys_log0</code>the table, and the remainder of 1 is stored <code>sys_log1</code>in the table.</p><h2 id="single-database-and-separate-tables" tabindex="-1"><a class="header-anchor" href="#single-database-and-separate-tables"><span><strong>Single database and separate tables</strong></span></a></h2><ol><li><code>jeecg-sharding.yaml</code>Create a new table configuration file in nacos as shown below</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">spring:</span>
<span class="line">  shardingsphere:</span>
<span class="line">    datasource:</span>
<span class="line">      names: ds0</span>
<span class="line">      ds0:</span>
<span class="line">        driverClassName: com.mysql.cj.jdbc.Driver</span>
<span class="line">        url: jdbc:mysql://jeecg-boot-mysql:3306/jeecg-boot?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=Asia/Seoul</span>
<span class="line">        username: root</span>
<span class="line">        password: root</span>
<span class="line">        type: com.alibaba.druid.pool.DruidDataSource</span>
<span class="line">    props:</span>
<span class="line">      sql-show: true</span>
<span class="line">    rules:</span>
<span class="line">      sharding:</span>
<span class="line">        binding-tables: sys_log</span>
<span class="line">        key-generators:</span>
<span class="line">          snowflake:</span>
<span class="line">            type: SNOWFLAKE</span>
<span class="line">            props:</span>
<span class="line">              worker-id: 123</span>
<span class="line">        sharding-algorithms:</span>
<span class="line">          table-classbased:</span>
<span class="line">            props:</span>
<span class="line">              strategy: standard</span>
<span class="line">              algorithmClassName: org.jeecg.modules.test.sharding.algorithm.StandardModTableShardAlgorithm</span>
<span class="line">            type: CLASS_BASED</span>
<span class="line">        tables:</span>
<span class="line">          sys_log:</span>
<span class="line">            actual-data-nodes: ds0.sys_log$-&gt;{0..1}</span>
<span class="line">            table-strategy:</span>
<span class="line">              standard:</span>
<span class="line">                sharding-algorithm-name: table-classbased</span>
<span class="line">                sharding-column: log_type</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><ol start="2"><li>Modify the jeecg-system-cloud-start project and introduce the newly added nacos configuration jeecg-sharding.yaml</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">- optional:nacos:jeecg-sharding.yaml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>copy</p><p><img src="https://upload.jeecg.com/jeecg/help/jeecgback/images/screenshot_1659852313143.png" alt=""></p><blockquote><p>Reminder: The name of the imported configuration file must be consistent with the file created by nacos, otherwise an error will be reported. Also, please try not to have Chinese characters in the configuration in nacos.</p></blockquote><p>3. Introduce the sharding test module jeecg-cloud-test-shardingsphere<br><img src="https://upload.jeecg.com/jeecg/help/jeecgback/images/screenshot_1659849653037.png" alt=""></p><p>4. After successful startup, enter <a href="http://localhost:9999" target="_blank" rel="noopener noreferrer">http://localhost:9999</a> in the browser to open the interface document as shown below<br><img src="https://upload.jeecg.com/jeecg/help/jeecgback/images/screenshot_1659849570414.png" alt=""></p><p>The following code inserts 10 data in batches. According to the allocation rule, data with non-odd logType will be inserted into the sys_log1 table, and data with non-even logType will be inserted into the sys_log0 table.<br><img src="https://lfs.k.topthink.com/lfs/8eaa972d15e82587437cfa5fd71db0c8dafc47a572ce4a12beaf188891bebe2c.dat" alt=""></p><p>The test results are as follows<br><img src="https://lfs.k.topthink.com/lfs/108eadaf460646e56868682c9f22146f7cbae55b182a62a89a34bd81da5a9721.dat" alt=""><br><img src="https://lfs.k.topthink.com/lfs/1048d79fe7eba85d4cac60c9fd4ba4afcc983e5afe90bef389c949b89feb7f3c.dat" alt=""></p><h2 id="sub-library-and-sub-table" tabindex="-1"><a class="header-anchor" href="#sub-library-and-sub-table"><span><strong>Sub-library and sub-table</strong></span></a></h2><ol><li><code>jeecg-sharding-multi.yaml</code>Create a new sub-library configuration file in nacos</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">spring:</span>
<span class="line">  shardingsphere:</span>
<span class="line">    datasource:</span>
<span class="line">      names: ds0,ds1</span>
<span class="line">      ds0:</span>
<span class="line">        driverClassName: com.mysql.cj.jdbc.Driver</span>
<span class="line">        url: jdbc:mysql://jeecg-boot-mysql:3306/jeecg-boot?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=Asia/Seoul</span>
<span class="line">        type: com.alibaba.druid.pool.DruidDataSource</span>
<span class="line">        username: root</span>
<span class="line">        password: root</span>
<span class="line">      ds1:</span>
<span class="line">        driverClassName: com.mysql.cj.jdbc.Driver</span>
<span class="line">        url: jdbc:mysql://jeecg-boot-mysql:3306/jeecg-boot2?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=Asia/Seoul</span>
<span class="line">        type: com.alibaba.druid.pool.DruidDataSource</span>
<span class="line">        username: root</span>
<span class="line">        password: root</span>
<span class="line">    props:</span>
<span class="line">      sql-show: true</span>
<span class="line">    rules:</span>
<span class="line">      replica-query:</span>
<span class="line">        load-balancers:</span>
<span class="line">          round-robin:</span>
<span class="line">            type: ROUND_ROBIN</span>
<span class="line">            props:</span>
<span class="line">              default: 0</span>
<span class="line">        data-sources:</span>
<span class="line">          prds:</span>
<span class="line">            primary-data-source-name: ds0</span>
<span class="line">            replica-data-source-names: ds1</span>
<span class="line">            load-balancer-name: round_robin</span>
<span class="line">      sharding:</span>
<span class="line">        binding-tables:</span>
<span class="line">          - sys_log</span>
<span class="line">        key-generators:</span>
<span class="line">          snowflake:</span>
<span class="line">            type: SNOWFLAKE</span>
<span class="line">            props:</span>
<span class="line">              worker-id: 123</span>
<span class="line">        sharding-algorithms:</span>
<span class="line">          table-classbased:</span>
<span class="line">            props:</span>
<span class="line">              strategy: standard</span>
<span class="line">              algorithmClassName: org.jeecg.modules.test.sharding.algorithm.StandardModTableShardAlgorithm</span>
<span class="line">            type: CLASS_BASED</span>
<span class="line">          database-inline:</span>
<span class="line">            type: INLINE</span>
<span class="line">            props:</span>
<span class="line">              algorithm-expression: ds$-&gt;{operate_type % 2}</span>
<span class="line">        tables:</span>
<span class="line">          sys_log:</span>
<span class="line">            actual-data-nodes: ds$-&gt;{0..1}.sys_log$-&gt;{0..1}</span>
<span class="line">            database-strategy:</span>
<span class="line">              standard:</span>
<span class="line">                sharding-column: operate_type</span>
<span class="line">                sharding-algorithm-name: database-inline</span>
<span class="line">            table-strategy:</span>
<span class="line">              standard:</span>
<span class="line">                sharding-algorithm-name: table-classbased</span>
<span class="line">                sharding-column: log_type</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><ol start="2"><li>Modify the jeecg-system-cloud-start project and introduce the newly added nacos configuration jeecg-sharding-multi.yaml</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">- optional:nacos:jeecg-sharding-multi.yaml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>copy</p><p><img src="https://upload.jeecg.com/jeecg/help/jeecgback/images/screenshot_1659878601565.png" alt=""></p><p>3. Test the insertion and query interface<br><img src="https://upload.jeecg.com/jeecg/help/jeecgback/images/screenshot_1659854609381.png" alt=""><br> Sample code:<br><img src="https://upload.jeecg.com/jeecg/help/jeecgback/images/screenshot_1659855142185.png" alt=""></p><p>4. The test results are as follows. You can see that the operation_type%2==0 has entered <code>jeecg-boot 库(ds0)</code>, and the operation_type%2==1 has entered.<code>jeecg-boot2库(ds1)</code><br><img src="https://lfs.k.topthink.com/lfs/16e4ffdcdf8cfa8ec0c9a5d2c162307ce9f0eb2c003cc791f6fd9bb4e2ad35be.dat" alt=""><br><img src="https://lfs.k.topthink.com/lfs/b00f97d4984aac1481b904cd5d7d4000f14f573111cc5ad5671aa57694d34e74.dat" alt=""></p><p>Others: ShardingSphere official document<br><a href="https://shardingsphere.apache.org/document/current/cn/overview%60" target="_blank" rel="noopener noreferrer">https://shardingsphere.apache.org/document/current/cn/overview`</a></p></div><!--[--><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link label" href="https://github.com/yourusername/vuepress-template/edit/main/docs/syncboot/microservice/common-starter-integration/sharding-sphere.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><svg class="edit-icon" viewbox="0 0 1024 1024"><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]--><!--]-->Edit this page on GitHub<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last updated: </span><time class="meta-item-info" datetime="2025-06-06T03:07:21.000Z" data-allow-mismatch>25. 6. 6. 오후 12:07</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: poh@empasy.com">poh</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-QFoJTndn.js" defer></script>
  </body>
</html>
