---
order: 13
---

# Define fill rules

> Automatically generate rule codes, for example: order number generation, prefix + year, month, day, hour, minute, second timestamp

How to create a rule implementation?

- Step 1: Implement the IFillRuleHandler interface

Reference examples:

```
/**
 * 填值规则Demo：生成订单号
 * 【测试示例】
 */
public class OrderNumberRule implements IFillRuleHandler {

    @Override
    public Object execute(JSONObject params, JSONObject formData) {
        String prefix = "CN";
        //订单前缀默认为CN 如果规则参数不为空，则取自定义前缀
        if (params != null) {
            Object obj = params.get("prefix");
            if (obj != null) prefix = obj.toString();
        }
        SimpleDateFormat format = new SimpleDateFormat("yyyyMMddHHmmss");
        int random = RandomUtils.nextInt(90) + 10;
        String value = prefix + format.format(new Date()) + random;
        // 根据formData的值的不同，生成不同的订单号
        String name = formData.getString("name");
        if (!StringUtils.isEmpty(name)) {
            value += name;
        }
        return value;
    }

}

```

copy

- Step 2: Configure in rule management  
  ![](https://lfs.k.topthink.com/lfs/1189b1e7b6a25fb591189173144e9f0cf623856221035cad0445defcfed8393e.dat)

- Step 3: Execute rule generation through the interface

parameter:

ruleCode | rule code  
formData | form data JSON

Interface URL: /sys/fillRule/executeRuleByCode/{ruleCode}

![](https://lfs.k.topthink.com/lfs/7ed051380eed58212f2eec9f4f01c78580dce70bf810fe7f749faed5b96e23b9.dat)

- Step 4: Batch encoding rule generation interface

/sys/fillRule/executeRuleByCode/executeRuleByCodeBatch

For specific usage, refer to:  
org.jeecg.modules.system.controller.SysFillRuleController#executeByRuleCodeBatch  
![](https://lfs.k.topthink.com/lfs/035ca52db9820c77e66714e427378af1fa12f2a47278078a8d513c15110f3659.dat)

## Other Tips

### How to directly call the generated code in JAVA code?

```
 * @param ruleCode 填值规则Code
 * @param formData  表单参数
FillRuleUtil.executeRule(String ruleCode, JSONObject formData)
```

copy

### How to call the generated code in the front-end JS?

The code can `put`be generated by requesting to call the background filling rule interface.

#### Example

```
<script setup>
import { defHttp } from '/@/utils/http/axios';
const ruleBaseURL = '/sys/fillRule/executeRuleByCode/';
import { ref } from 'vue';
const orderNum = ref('');
const url = ruleBaseURL + 'order_num_rule';
const getOrderNum = () => {
    defHttp.put({ url }, { isTransformResponse: false }).then((res) => {
        // 执行成功，获取返回的值，并赋到页面上
        if (res.success) {
            orderNum.value = res.result;
        }
    });
};
</script>

```

copy

### How to call the generated code in the JS enhancement of the Online form?

You can use `putAction`methods to call the interface to generate code  
![](https://lfs.k.topthink.com/lfs/ac5a225766c56d860ebce2b9a807e0fd846c3baee81cd9e337ee0cff015fbc20.dat)

### How to call the generated code in the form designer JS enhancement?

You can use `api.put()`the method to get the value of the fill-in rule, and then `api.setFormData()`assign it to the page through the method.  
For how to use the api, see `表单设计器-->高级操作手册-->JS增强`the document

#### Example

```
// 获取所有 form data
var formData = api.getFormData() || {}
// 请求后台的填值规则接口地址
var url = '/sys/fillRule/executeRuleByCode/'
var ruleCode = 'order_num_rule'
api.put(url + ruleCode, formData).then(res => {
  // 执行成功，获取返回的值，并赋到页面上
  if (res.success) {
    var value = res.result
    api.setFormData('orderNum', value)
  }
})
```

copy
