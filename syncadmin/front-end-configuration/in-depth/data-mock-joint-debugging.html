<!doctype html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.22" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/images/logo.png"><meta name="author" content="The VuePress Team"><meta name="keywords" content="vuepress, vue, Documentation, Blog"><meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png"><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#3eaf7c"><meta name="msapplication-TileImage" content="/images/icons/mstile-150x150.png"><meta name="msapplication-TileColor" content="#3eaf7c"><meta name="application-name" content="VuePress Document templates"><meta name="mobile-web-app-capable" content="yes"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><title>Data mock & joint debugging</title><meta name="description" content="The Empasy document">
    <link rel="preload" href="/assets/style-CZXcHujW.css" as="style"><link rel="stylesheet" href="/assets/style-CZXcHujW.css">
    <link rel="modulepreload" href="/assets/app-CC5quYyA.js"><link rel="modulepreload" href="/assets/data-mock-joint-debugging.html-866MZ10P.js">
    
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="/images/logo-dark.png" alt><!----></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Homepage"><!--[--><!--[--><!--]--><!--]-->Homepage<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synceta/" aria-label="SyncETA"><!--[--><!--[--><!--]--><!--]-->SyncETA<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/syncboot/" aria-label="SyncBoot"><!--[--><!--[--><!--]--><!--]-->SyncBoot<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synccms/" aria-label="SyncCms"><!--[--><!--[--><!--]--><!--]-->SyncCms<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/syncadmin/" aria-label="SyncAdmin"><!--[--><!--[--><!--]--><!--]-->SyncAdmin<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/yourusername/vuepress-template" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->GitHub<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search for documents" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Homepage"><!--[--><!--[--><!--]--><!--]-->Homepage<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synceta/" aria-label="SyncETA"><!--[--><!--[--><!--]--><!--]-->SyncETA<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/syncboot/" aria-label="SyncBoot"><!--[--><!--[--><!--]--><!--]-->SyncBoot<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/synccms/" aria-label="SyncCms"><!--[--><!--[--><!--]--><!--]-->SyncCms<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/syncadmin/" aria-label="SyncAdmin"><!--[--><!--[--><!--]--><!--]-->SyncAdmin<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/yourusername/vuepress-template" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->GitHub<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading collapsible">SyncAdmin <span class="right arrow"></span></p><ul style="display:none;" class="vp-sidebar-children"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item" href="/syncadmin/" aria-label="Summary"><!--[--><!--[--><!--]--><!--]-->Summary<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/syncadmin/Introduction.html" aria-label="Introduction"><!--[--><!--[--><!--]--><!--]-->Introduction<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="data-mock-joint-debugging" tabindex="-1"><a class="header-anchor" href="#data-mock-joint-debugging"><span>Data mock &amp; joint debugging</span></a></h1><h2 id="development-environment" tabindex="-1"><a class="header-anchor" href="#development-environment"><span>Development Environment</span></a></h2><p>If the front-end application and the back-end API server are not running on the same host, you need to proxy the API requests to the API server in the development environment.</p><p>If it is the same host, you can directly request the specific interface address.</p><h3 id="configuration" tabindex="-1"><a class="header-anchor" href="#configuration"><span>Configuration</span></a></h3><p>In the development environment, the interface address is in the project root directory</p><p><a href="https://github.com/vbenjs/vue-vben-admin/tree/main/.env.development" target="_blank" rel="noopener noreferrer">.env.development</a> file configuration</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"># vite 本地跨域代理</span>
<span class="line">VITE_PROXY=[[&quot;/basic-api&quot;,&quot;http://localhost:3000&quot;]]</span>
<span class="line"># 接口地址</span>
<span class="line">VITE_GLOB_API_URL=/api</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><ul><li>If the fields in the .env file are strings, there is no need to add quotes. By default, all fields are strings.</li><li>VITE_PROXY cannot wrap</li></ul></div><h3 id="cross-domain-processing" tabindex="-1"><a class="header-anchor" href="#cross-domain-processing"><span>Cross-domain processing</span></a></h3><p>If <code>src/api/</code>the interface below is the code below and the <strong>.env.development</strong> file is configured with the following comments, the address you see in the console is <code>http://localhost:3100/basic-api/login</code>.</p><p>Since <code>/basic-api</code>it matches the settings <code>VITE_PROXY</code>, the above actually requests <a href="http://localhost:3000/login" target="_blank" rel="noopener noreferrer">http://localhost:3000/login</a> , which also solves the cross-domain problem. ( <strong>3100</strong> is the project port number, and <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">http://localhost:3000</a> is the target address of the PROXY proxy)</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">// .env.development</span>
<span class="line">// VITE_PROXY=[[&quot;/basic-api&quot;,&quot;http://localhost:3000&quot;]]</span>
<span class="line">// VITE_GLOB_API_URL=/basic-api</span>
<span class="line"></span>
<span class="line">enum Api {</span>
<span class="line">  Login = &#39;/login&#39;,</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">/**</span>
<span class="line"> * @description: 用户登陆</span>
<span class="line"> */</span>
<span class="line">export function loginApi(params: LoginParams) {</span>
<span class="line">  return http.request&lt;LoginResultModel&gt;({</span>
<span class="line">    url: Api.Login,</span>
<span class="line">    method: &#39;POST&#39;,</span>
<span class="line">    params,</span>
<span class="line">  });</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h3 id="no-cross-domain-configuration" tabindex="-1"><a class="header-anchor" href="#no-cross-domain-configuration"><span>No cross-domain configuration</span></a></h3><p>If there is no cross-domain problem, you can ignore the <strong>VITE_PROXY</strong> configuration and directly set the interface address to <strong>VITE_GLOB_API_URL</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"># 例如接口地址为 http://localhost:3000 则</span>
<span class="line">VITE_GLOB_API_URL=http://localhost:3000</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><p>If there is a cross-domain problem, just set <strong>VITE_GLOB_API_URL</strong> to a value that matches the first item in one of the arrays in <strong>VITE_PROXY .</strong></p><p>The interface address below is set to <code>/basic-api</code>, when the request is sent, it will pass through Vite&#39;s proxy, match the <strong>VITE_PROXY</strong> rule we set, and <code>/basic-api</code>convert it to <code>http://localhost:3000</code>make a request</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"># 例如接口地址为 http://localhost:3000 则</span>
<span class="line">VITE_PROXY=[[&quot;/basic-api&quot;,&quot;http://localhost:3000&quot;]]</span>
<span class="line"># 接口地址</span>
<span class="line">VITE_GLOB_API_URL=/basic-api</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h3 id="analysis-of-cross-domain-principles" tabindex="-1"><a class="header-anchor" href="#analysis-of-cross-domain-principles"><span>Analysis of cross-domain principles</span></a></h3><p>In <code>vite.config.ts</code>the configuration file, the server&#39;s proxy function is provided to proxy API requests.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">server: {</span>
<span class="line">  proxy: {</span>
<span class="line">    &quot;/basic-api&quot;:{</span>
<span class="line">      target: &#39;http://localhost:3000&#39;,</span>
<span class="line">      changeOrigin: true,</span>
<span class="line">      ws: true,</span>
<span class="line">      rewrite: (path) =&gt; path.replace(new RegExp(`^/basic-api`), &#39;&#39;),</span>
<span class="line">    }</span>
<span class="line">  },</span>
<span class="line">},</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>From the browser console&#39;s Network, the request is <code>http://localhost:3000/basic-api/xxx</code>, this is because the proxy configuration will not change the URL of the local request.</p></div><h2 id="production-environment" tabindex="-1"><a class="header-anchor" href="#production-environment"><span>Production Environment</span></a></h2><p><a href="https://github.com/vbenjs/vue-vben-admin/tree/main/.env.production" target="_blank" rel="noopener noreferrer">The production environment interface address is configured in the .env.production</a> file in the project root directory .</p><p>The production environment interface address value needs to be modified <strong>VITE_GLOB_API_URL</strong> . If cross-domain problems occur, you can use nginx or enable cors in the background to handle it.</p><div class="hint-container tip"><p class="hint-container-title">How to modify the address after packaging?</p><p><strong>Variables starting with VITE_GLOB_* will be injected into the</strong> <strong>_app.config.js</strong> file during packaging .</p><p>After modifying the corresponding interface address in <strong>dist/_app.config.js, just refresh the page. There is no need to package multiple times according to different environments. One package can be used for deployment in multiple different interface environments.</strong></p></div><h2 id="interface-request" tabindex="-1"><a class="header-anchor" href="#interface-request"><span>Interface Request</span></a></h2><p>In vue-vben-admin:</p><ol><li>Page interaction operations;</li><li>Call the unified management API request function;</li><li>Use the encapsulated axios.ts to send the request;</li><li>Get the data returned by the server</li><li>Update data;</li></ol><p>The interfaces are uniformly stored in <a href="https://github.com/vbenjs/vue-vben-admin/tree/main/src/api" target="_blank" rel="noopener noreferrer">src/api/</a> and managed below</p><p>Take the login interface as an example:</p><p>Create a new module file in <strong>src/api/</strong> , where it is best to define the types of parameters and return values ​​for easy verification. Although it is troublesome, it is very convenient to maintain the fields later.</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>Type definition files can be extracted and managed in a unified manner. For details, refer to the project</p></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">import { defHttp } from &#39;/@/utils/http/axios&#39;;</span>
<span class="line">import { LoginParams, LoginResultModel } from &#39;./model/userModel&#39;;</span>
<span class="line"></span>
<span class="line">enum Api {</span>
<span class="line">  Login = &#39;/login&#39;,</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">export function loginApi(params: LoginParams) {</span>
<span class="line">  return defHttp.request&lt;LoginResultModel&gt;({</span>
<span class="line">    url: Api.Login,</span>
<span class="line">    method: &#39;POST&#39;,</span>
<span class="line">    params,</span>
<span class="line">  });</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h2 id="axios-configuration" tabindex="-1"><a class="header-anchor" href="#axios-configuration"><span>axios configuration</span></a></h2><p><strong>Axios</strong> request encapsulation is stored in <a href="https://github.com/vbenjs/vue-vben-admin/tree/main/src/utils/http/axios" target="_blank" rel="noopener noreferrer">the src/utils/http/axios</a> folder</p><p>Except for <code>index.ts</code>the file content, which needs to be modified according to the project, the rest of the files do not need to be modified.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"></span>
<span class="line">├── Axios.ts // axios实例</span>
<span class="line">├── axiosCancel.ts // axiosCancel实例，取消重复请求</span>
<span class="line">├── axiosTransform.ts // 数据转换类</span>
<span class="line">├── checkStatus.ts // 返回状态值校验</span>
<span class="line">├── index.ts // 接口返回统一处理</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h3 id="index-ts-configuration-instructions" tabindex="-1"><a class="header-anchor" href="#index-ts-configuration-instructions"><span>index.ts configuration instructions</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">const axios = new VAxios({</span>
<span class="line">  // 认证方案，例如: Bearer</span>
<span class="line">  // https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication#authentication_schemes</span>
<span class="line">  authenticationScheme: &#39;&#39;,</span>
<span class="line">  // 接口超时时间 单位毫秒</span>
<span class="line">  timeout: 10 * 1000,</span>
<span class="line">  // 接口可能会有通用的地址部分，可以统一抽取出来</span>
<span class="line">  prefixUrl: prefix,</span>
<span class="line">  headers: { &#39;Content-Type&#39;: ContentTypeEnum.JSON },</span>
<span class="line">  // 数据处理方式，见下方说明</span>
<span class="line">  transform,</span>
<span class="line">  // 配置项，下面的选项都可以在独立的接口请求中覆盖</span>
<span class="line">  requestOptions: {</span>
<span class="line">    // 默认将prefix 添加到url</span>
<span class="line">    joinPrefix: true,</span>
<span class="line">    // 是否返回原生响应头 比如：需要获取响应头时使用该属性</span>
<span class="line">    isReturnNativeResponse: false,</span>
<span class="line">    // 需要对返回数据进行处理</span>
<span class="line">    isTransformRequestResult: true,</span>
<span class="line">    // post请求的时候添加参数到url</span>
<span class="line">    joinParamsToUrl: false,</span>
<span class="line">    // 格式化提交参数时间</span>
<span class="line">    formatDate: true,</span>
<span class="line">    // 消息提示类型</span>
<span class="line">    errorMessageMode: &#39;message&#39;,</span>
<span class="line">    // 接口地址</span>
<span class="line">    apiUrl: globSetting.apiUrl,</span>
<span class="line">    //  是否加入时间戳</span>
<span class="line">    joinTime: true,</span>
<span class="line">    // 忽略重复请求</span>
<span class="line">    ignoreCancelToken: true,</span>
<span class="line">  },</span>
<span class="line">});</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><p><strong>Transform data processing instructions</strong></p><p>For type definition, see <strong>the axiosTransform.ts</strong> file</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">export abstract class AxiosTransform {</span>
<span class="line">  /**</span>
<span class="line">   * @description: 请求之前处理配置</span>
<span class="line">   */</span>
<span class="line">  beforeRequestHook?: (config: AxiosRequestConfig, options: RequestOptions) =&gt; AxiosRequestConfig;</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 请求成功处理</span>
<span class="line">   */</span>
<span class="line">  transformRequestData?: (res: AxiosResponse&lt;Result&gt;, options: RequestOptions) =&gt; any;</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 请求失败处理</span>
<span class="line">   */</span>
<span class="line">  requestCatch?: (e: Error) =&gt; Promise&lt;any&gt;;</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 请求之前的拦截器</span>
<span class="line">   */</span>
<span class="line">  requestInterceptors?: (config: AxiosRequestConfig) =&gt; AxiosRequestConfig;</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 请求之后的拦截器</span>
<span class="line">   */</span>
<span class="line">  responseInterceptors?: (res: AxiosResponse&lt;any&gt;) =&gt; AxiosResponse&lt;any&gt;;</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 请求之前的拦截器错误处理</span>
<span class="line">   */</span>
<span class="line">  requestInterceptorsCatch?: (error: Error) =&gt; void;</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 请求之后的拦截器错误处理</span>
<span class="line">   */</span>
<span class="line">  responseInterceptorsCatch?: (error: Error) =&gt; void;</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><p>The project default transform processing logic can be processed according to the respective project. The part that generally needs to be changed is the code below, see the code comment description</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">/**</span>
<span class="line"> * @description: 数据处理，方便区分多种处理方式</span>
<span class="line"> */</span>
<span class="line">const transform: AxiosTransform = {</span>
<span class="line">  /**</span>
<span class="line">   * @description: 处理请求数据。如果数据不是预期格式，可直接抛出错误</span>
<span class="line">   */</span>
<span class="line">  transformRequestHook: (res: AxiosResponse&lt;Result&gt;, options: RequestOptions) =&gt; {</span>
<span class="line">    const { t } = useI18n();</span>
<span class="line">    const { isTransformResponse, isReturnNativeResponse } = options;</span>
<span class="line">    // 是否返回原生响应头 比如：需要获取响应头时使用该属性</span>
<span class="line">    if (isReturnNativeResponse) {</span>
<span class="line">      return res;</span>
<span class="line">    }</span>
<span class="line">    // 不进行任何处理，直接返回</span>
<span class="line">    // 用于页面代码可能需要直接获取code，data，message这些信息时开启</span>
<span class="line">    if (!isTransformResponse) {</span>
<span class="line">      return res.data;</span>
<span class="line">    }</span>
<span class="line">    // 错误的时候返回</span>
<span class="line"></span>
<span class="line">    const { data } = res;</span>
<span class="line">    if (!data) {</span>
<span class="line">      // return &#39;[HTTP] Request has no return value&#39;;</span>
<span class="line">      throw new Error(t(&#39;sys.api.apiRequestFailed&#39;));</span>
<span class="line">    }</span>
<span class="line">    //  这里 code，result，message为 后台统一的字段，需要在 types.ts内修改为项目自己的接口返回格式</span>
<span class="line">    const { code, result, message } = data;</span>
<span class="line"></span>
<span class="line">    // 这里逻辑可以根据项目进行修改</span>
<span class="line">    const hasSuccess = data &amp;&amp; Reflect.has(data, &#39;code&#39;) &amp;&amp; code === ResultEnum.SUCCESS;</span>
<span class="line">    if (hasSuccess) {</span>
<span class="line">      return result;</span>
<span class="line">    }</span>
<span class="line"></span>
<span class="line">    // 在此处根据自己项目的实际情况对不同的code执行不同的操作</span>
<span class="line">    // 如果不希望中断当前请求，请return数据，否则直接抛出异常即可</span>
<span class="line">    let timeoutMsg = &#39;&#39;;</span>
<span class="line">    switch (code) {</span>
<span class="line">      case ResultEnum.TIMEOUT:</span>
<span class="line">        timeoutMsg = t(&#39;sys.api.timeoutMessage&#39;);</span>
<span class="line">      default:</span>
<span class="line">        if (message) {</span>
<span class="line">          timeoutMsg = message;</span>
<span class="line">        }</span>
<span class="line">    }</span>
<span class="line"></span>
<span class="line">    // errorMessageMode=‘modal’的时候会显示modal错误弹窗，而不是消息提示，用于一些比较重要的错误</span>
<span class="line">    // errorMessageMode=&#39;none&#39; 一般是调用时明确表示不希望自动弹出错误提示</span>
<span class="line">    if (options.errorMessageMode === &#39;modal&#39;) {</span>
<span class="line">      createErrorModal({ title: t(&#39;sys.api.errorTip&#39;), content: timeoutMsg });</span>
<span class="line">    } else if (options.errorMessageMode === &#39;message&#39;) {</span>
<span class="line">      createMessage.error(timeoutMsg);</span>
<span class="line">    }</span>
<span class="line"></span>
<span class="line">    throw new Error(timeoutMsg || t(&#39;sys.api.apiRequestFailed&#39;));</span>
<span class="line">  },</span>
<span class="line"></span>
<span class="line">  // 请求之前处理config</span>
<span class="line">  beforeRequestHook: (config, options) =&gt; {</span>
<span class="line">    const { apiUrl, joinPrefix, joinParamsToUrl, formatDate, joinTime = true } = options;</span>
<span class="line"></span>
<span class="line">    if (joinPrefix) {</span>
<span class="line">      config.url = `${urlPrefix}${config.url}`;</span>
<span class="line">    }</span>
<span class="line"></span>
<span class="line">    if (apiUrl &amp;&amp; isString(apiUrl)) {</span>
<span class="line">      config.url = `${apiUrl}${config.url}`;</span>
<span class="line">    }</span>
<span class="line">    const params = config.params || {};</span>
<span class="line">    if (config.method?.toUpperCase() === RequestEnum.GET) {</span>
<span class="line">      if (!isString(params)) {</span>
<span class="line">        // 给 get 请求加上时间戳参数，避免从缓存中拿数据。</span>
<span class="line">        config.params = Object.assign(params || {}, joinTimestamp(joinTime, false));</span>
<span class="line">      } else {</span>
<span class="line">        // 兼容restful风格</span>
<span class="line">        config.url = config.url + params + `${joinTimestamp(joinTime, true)}`;</span>
<span class="line">        config.params = undefined;</span>
<span class="line">      }</span>
<span class="line">    } else {</span>
<span class="line">      if (!isString(params)) {</span>
<span class="line">        formatDate &amp;&amp; formatRequestDate(params);</span>
<span class="line">        config.data = params;</span>
<span class="line">        config.params = undefined;</span>
<span class="line">        if (joinParamsToUrl) {</span>
<span class="line">          config.url = setObjToUrlParams(config.url as string, config.data);</span>
<span class="line">        }</span>
<span class="line">      } else {</span>
<span class="line">        // 兼容restful风格</span>
<span class="line">        config.url = config.url + params;</span>
<span class="line">        config.params = undefined;</span>
<span class="line">      }</span>
<span class="line">    }</span>
<span class="line">    return config;</span>
<span class="line">  },</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 请求拦截器处理</span>
<span class="line">   */</span>
<span class="line">  requestInterceptors: (config, options) =&gt; {</span>
<span class="line">    // 请求之前处理config</span>
<span class="line">    const token = getToken();</span>
<span class="line">    if (token) {</span>
<span class="line">      // jwt token</span>
<span class="line">      config.headers.Authorization = options.authenticationScheme</span>
<span class="line">        ? `${options.authenticationScheme} ${token}`</span>
<span class="line">        : token;</span>
<span class="line">    }</span>
<span class="line">    return config;</span>
<span class="line">  },</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 响应拦截器处理</span>
<span class="line">   */</span>
<span class="line">  responseInterceptors: (res: AxiosResponse&lt;any&gt;) =&gt; {</span>
<span class="line">    return res;</span>
<span class="line">  },</span>
<span class="line"></span>
<span class="line">  /**</span>
<span class="line">   * @description: 响应错误处理</span>
<span class="line">   */</span>
<span class="line">  responseInterceptorsCatch: (error: any) =&gt; {</span>
<span class="line">    const { t } = useI18n();</span>
<span class="line">    const errorLogStore = useErrorLogStoreWithOut();</span>
<span class="line">    errorLogStore.addAjaxErrorInfo(error);</span>
<span class="line">    const { response, code, message, config } = error || {};</span>
<span class="line">    const errorMessageMode = config?.requestOptions?.errorMessageMode || &#39;none&#39;;</span>
<span class="line">    const msg: string = response?.data?.error?.message ?? &#39;&#39;;</span>
<span class="line">    const err: string = error?.toString?.() ?? &#39;&#39;;</span>
<span class="line">    let errMessage = &#39;&#39;;</span>
<span class="line"></span>
<span class="line">    try {</span>
<span class="line">      if (code === &#39;ECONNABORTED&#39; &amp;&amp; message.indexOf(&#39;timeout&#39;) !== -1) {</span>
<span class="line">        errMessage = t(&#39;sys.api.apiTimeoutMessage&#39;);</span>
<span class="line">      }</span>
<span class="line">      if (err?.includes(&#39;Network Error&#39;)) {</span>
<span class="line">        errMessage = t(&#39;sys.api.networkExceptionMsg&#39;);</span>
<span class="line">      }</span>
<span class="line"></span>
<span class="line">      if (errMessage) {</span>
<span class="line">        if (errorMessageMode === &#39;modal&#39;) {</span>
<span class="line">          createErrorModal({ title: t(&#39;sys.api.errorTip&#39;), content: errMessage });</span>
<span class="line">        } else if (errorMessageMode === &#39;message&#39;) {</span>
<span class="line">          createMessage.error(errMessage);</span>
<span class="line">        }</span>
<span class="line">        return Promise.reject(error);</span>
<span class="line">      }</span>
<span class="line">    } catch (error) {</span>
<span class="line">      throw new Error(error);</span>
<span class="line">    }</span>
<span class="line"></span>
<span class="line">    checkStatus(error?.response?.status, msg, errorMessageMode);</span>
<span class="line">    return Promise.reject(error);</span>
<span class="line">  },</span>
<span class="line">};</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h3 id="changing-parameter-format" tabindex="-1"><a class="header-anchor" href="#changing-parameter-format"><span>Changing parameter format</span></a></h3><p>The project interface defaults to the Json parameter format, that is <code>headers: { &#39;Content-Type&#39;: ContentTypeEnum.JSON }</code>,</p><p>If you need to change to the format, just <code>form-data</code>change the headers <code>&#39;Content-Type</code>to<code>ContentTypeEnum.FORM_URLENCODED</code></p><h3 id="multiple-interface-addresses" tabindex="-1"><a class="header-anchor" href="#multiple-interface-addresses"><span>Multiple interface addresses</span></a></h3><p>When multiple interface addresses are needed in the project, you can export multiple axios instances in <a href="https://github.com/vbenjs/vue-vben-admin/tree/main/src/utils/http/axios/index.ts" target="_blank" rel="noopener noreferrer">src/utils/http/axios/index.ts</a></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">// 目前只导出一个默认实例，接口地址对应的是环境变量中的 VITE_GLOB_API_URL 接口地址</span>
<span class="line">export const defHttp = createAxios();</span>
<span class="line"></span>
<span class="line">// 需要有其他接口地址的可以在后面添加</span>
<span class="line"></span>
<span class="line">// other api url</span>
<span class="line">export const otherHttp = createAxios({</span>
<span class="line">  requestOptions: {</span>
<span class="line">    apiUrl: &#39;xxx&#39;,</span>
<span class="line">  },</span>
<span class="line">});</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h3 id="delete-the-timestamp-parameter-carried-in-the-request-url" tabindex="-1"><a class="header-anchor" href="#delete-the-timestamp-parameter-carried-in-the-request-url"><span>Delete the timestamp parameter carried in the request URL</span></a></h3><p>If you do not need the default timestamp parameter on the URL<code>?_t=xxx</code></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">const axios = new VAxios({</span>
<span class="line">  requestOptions: {</span>
<span class="line">    // 是否加入时间戳</span>
<span class="line">    joinTime: false,</span>
<span class="line">  },</span>
<span class="line">});</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h2 id="mock-service" tabindex="-1"><a class="header-anchor" href="#mock-service"><span>Mock Service</span></a></h2><p>Mock data is an essential part of the front-end development process and a key link in separating front-end and back-end development. By simulating request data and even logic through pre-agreed interfaces with the server, front-end development can be independent and will not be blocked by the server&#39;s development process.</p><p>This project uses <a href="https://github.com/vbenjs/vite-plugin-mock" target="_blank" rel="noopener noreferrer">vite-plugin-mock</a> to perform mock data processing. <strong>The mock services in the project are divided into local and online</strong> .</p><h3 id="local-mock" tabindex="-1"><a class="header-anchor" href="#local-mock"><span>Local Mock</span></a></h3><p>The local mock uses Node.js middleware to intercept parameters (the reason for not using mock.js is that local development cannot see request parameters and response results).</p><h4 id="how-to-add-a-mock-interface" tabindex="-1"><a class="header-anchor" href="#how-to-add-a-mock-interface"><span>How to add a mock interface</span></a></h4><p>If you want to add mock data, just find the mock file in the root directory, add the corresponding interface, intercept it and simulate the data.</p><p>Create a new file in the mock folder</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>The file will be automatically updated after it is added, without manual restart. You can view the log information in the code console. The mock folder will be automatically registered, excluding folders and files starting with _</p></div><p>example:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">import { MockMethod } from &#39;vite-plugin-mock&#39;;</span>
<span class="line">import { resultPageSuccess } from &#39;../_util&#39;;</span>
<span class="line"></span>
<span class="line">const demoList = (() =&gt; {</span>
<span class="line">  const result: any[] = [];</span>
<span class="line">  for (let index = 0; index &lt; 60; index++) {</span>
<span class="line">    result.push({</span>
<span class="line">      id: `${index}`,</span>
<span class="line">      beginTime: &#39;@datetime&#39;,</span>
<span class="line">      endTime: &#39;@datetime&#39;,</span>
<span class="line">      address: &#39;@city()&#39;,</span>
<span class="line">      name: &#39;@cname()&#39;,</span>
<span class="line">      &#39;no|100000-10000000&#39;: 100000,</span>
<span class="line">      &#39;status|1&#39;: [&#39;正常&#39;, &#39;启用&#39;, &#39;停用&#39;],</span>
<span class="line">    });</span>
<span class="line">  }</span>
<span class="line">  return result;</span>
<span class="line">})();</span>
<span class="line"></span>
<span class="line">export default [</span>
<span class="line">  {</span>
<span class="line">    url: &#39;/api/table/getDemoList&#39;,</span>
<span class="line">    timeout: 1000,</span>
<span class="line">    method: &#39;get&#39;,</span>
<span class="line">    response: ({ query }) =&gt; {</span>
<span class="line">      const { page = 1, pageSize = 20 } = query;</span>
<span class="line">      return resultPageSuccess(page, pageSize, demoList);</span>
<span class="line">    },</span>
<span class="line">  },</span>
<span class="line">] as MockMethod[];</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>The value of mock can directly use the syntax of <a href="https://github.com/nuysoft/Mock/wiki" target="_blank" rel="noopener noreferrer">mockjs</a> .</p></div><h4 id="interface-format" tabindex="-1"><a class="header-anchor" href="#interface-format"><span>Interface format</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">{</span>
<span class="line">  url: string; // mock 接口地址</span>
<span class="line">  method?: MethodType; // 请求方式</span>
<span class="line">  timeout?: number; // 延时时间</span>
<span class="line">  statusCode: number; // 响应状态码</span>
<span class="line">  response: ((opt: { // 响应结果</span>
<span class="line">      body: any;</span>
<span class="line">      query: any;</span>
<span class="line">  }) =&gt; any) | object;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h4 id="parameter-acquisition" tabindex="-1"><a class="header-anchor" href="#parameter-acquisition"><span>Parameter acquisition</span></a></h4><p><strong>GET interface:</strong> <code>({ query }) =&gt; { }</code></p><p><strong>POST interface:</strong> <code>({ body }) =&gt; { }</code></p><h4 id="util-description" tabindex="-1"><a class="header-anchor" href="#util-description"><span>util Description</span></a></h4><p>You can see it in <a href="https://github.com/vbenjs/vue-vben-admin/tree/main/mock/_util.ts" target="_blank" rel="noopener noreferrer">the code</a></p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>util is only used as service processing result data. It is not necessary. If you need to use it, you can encapsulate it yourself and change the corresponding fields to the return structure of the interface.</p></div><h4 id="match" tabindex="-1"><a class="header-anchor" href="#match"><span>match</span></a></h4><p>In <code>src/api</code>the following, if the interface matches the mock, the mock will be used first to respond.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">import { defHttp } from &#39;/@/utils/http/axios&#39;;</span>
<span class="line">import { LoginParams, LoginResultModel } from &#39;./model/userModel&#39;;</span>
<span class="line"></span>
<span class="line">enum Api {</span>
<span class="line">  Login = &#39;/login&#39;,</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">/**</span>
<span class="line"> * @description: user login api</span>
<span class="line"> */</span>
<span class="line">export function loginApi(params: LoginParams) {</span>
<span class="line">  return defHttp.request&lt;LoginResultModel&gt;(</span>
<span class="line">    {</span>
<span class="line">      url: Api.Login,</span>
<span class="line">      method: &#39;POST&#39;,</span>
<span class="line">      params,</span>
<span class="line">    },</span>
<span class="line">    {</span>
<span class="line">      errorMessageMode: &#39;modal&#39;,</span>
<span class="line">    }</span>
<span class="line">  );</span>
<span class="line">}</span>
<span class="line">// 会匹配到上方的</span>
<span class="line">export default [</span>
<span class="line">  {</span>
<span class="line">    url: &#39;/api/login&#39;,</span>
<span class="line">    timeout: 1000,</span>
<span class="line">    method: &#39;POST&#39;,</span>
<span class="line">    response: ({ body }) =&gt; {</span>
<span class="line">      return resultPageSuccess({});</span>
<span class="line">    },</span>
<span class="line">  },</span>
<span class="line">] as MockMethod[];</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h4 id="now-that-we-have-an-interface-how-do-we-remove-the-mock" tabindex="-1"><a class="header-anchor" href="#now-that-we-have-an-interface-how-do-we-remove-the-mock"><span>Now that we have an interface, how do we remove the mock?</span></a></h4><p>When the backend interface has been developed, you only need to remove the corresponding mock function.</p><p>Taking the above interface as an example, if the backend interface login has been developed, you only need to delete/comment out the following code</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">export default [</span>
<span class="line">  {</span>
<span class="line">    url: &#39;/api/login&#39;,</span>
<span class="line">    timeout: 1000,</span>
<span class="line">    method: &#39;POST&#39;,</span>
<span class="line">    response: ({ body }) =&gt; {</span>
<span class="line">      return resultPageSuccess({});</span>
<span class="line">    },</span>
<span class="line">  },</span>
<span class="line">] as MockMethod[];</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><h3 id="online-mock" tabindex="-1"><a class="header-anchor" href="#online-mock"><span>Online mock</span></a></h3><p>Since this project is a demonstration project, mock data is also used online, so mocks are also integrated after packaging. Usually, the online project is generally a formal interface.</p><p>The online mock of the project uses <a href="https://github.com/nuysoft/Mock/wiki" target="_blank" rel="noopener noreferrer">mockjs</a> to simulate mock data.</p><h4 id="how-to-start-mock-online" tabindex="-1"><a class="header-anchor" href="#how-to-start-mock-online"><span>How to start mock online</span></a></h4><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>Enabling mock online is only suitable for some simple sample websites and preview websites. <strong>Do not enable it in a formal production environment!!!</strong></p></div><ol><li><code>VITE_USE_MOCK</code>Modify the value of true in the .env.production file</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">VITE_USE_MOCK = true;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>copy</p><ol start="2"><li>Introduce the required mock files in the mock <a href="https://github.com/vbenjs/vue-vben-admin/tree/main/mock/_createProductionServer.ts" target="_blank" rel="noopener noreferrer">/_createProductionServer.ts file</a></li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">import { createProdMockServer } from &#39;vite-plugin-mock/es/createProdMockServer&#39;;</span>
<span class="line"></span>
<span class="line">const modules = import.meta.globEager(&#39;./**/*.ts&#39;);</span>
<span class="line"></span>
<span class="line">const mockModules: any[] = [];</span>
<span class="line">Object.keys(modules).forEach((key) =&gt; {</span>
<span class="line">  if (key.includes(&#39;/_&#39;)) {</span>
<span class="line">    return;</span>
<span class="line">  }</span>
<span class="line">  mockModules.push(...modules[key].default);</span>
<span class="line">});</span>
<span class="line"></span>
<span class="line">export function setupProdMockServer() {</span>
<span class="line">  createProdMockServer(mockModules);</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><ol start="3"><li>Introduce in build <a href="https://github.com/vbenjs/vue-vben-admin/tree/main/build/vite/plugin/mock.ts" target="_blank" rel="noopener noreferrer">/vite/plugin/mock.ts</a></li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">import { viteMockServe } from &#39;vite-plugin-mock&#39;;</span>
<span class="line"></span>
<span class="line">export function configMockPlugin(isBuild: boolean) {</span>
<span class="line">  return viteMockServe({</span>
<span class="line">    injectCode: `</span>
<span class="line">      import { setupProdMockServer } from &#39;../mock/_createProductionServer&#39;;</span>
<span class="line"></span>
<span class="line">      setupProdMockServer();</span>
<span class="line">      `,</span>
<span class="line">  });</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>copy</p><div class="hint-container tip"><p class="hint-container-title">Why inject code through plugins instead of directly inserting it in main.ts</p><p>By inserting code in the plugin <code>injectCode</code>, it is convenient to control whether mockjs is packaged into the final code. If you judge in main.ts, if the mock function is turned off, mockjs will also be packaged into the build file, which will increase the package size.</p></div><p>At this point, the online mock configuration is complete. There is little difference between online and local. The biggest difference is that you cannot see the interface request log in the online console.</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link label" href="https://github.com/yourusername/vuepress-template/edit/main/docs/syncadmin/front-end-configuration/in-depth/data-mock-joint-debugging.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><svg class="edit-icon" viewbox="0 0 1024 1024"><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]--><!--]-->Edit this page on GitHub<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last updated: </span><time class="meta-item-info" datetime="2025-06-09T23:03:22.000Z" data-allow-mismatch>25. 6. 9. 오후 11:03</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: poh@empasy.com">poh</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CC5quYyA.js" defer></script>
  </body>
</html>
